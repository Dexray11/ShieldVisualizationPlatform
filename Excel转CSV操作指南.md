# Excel转CSV详细操作指南

## 🎯 目的

将Excel文件（.xlsx）转换为CSV UTF-8格式，以便在盾构地质可视化平台中导入。

---

## 📝 操作步骤

### 方法一：Excel 2016及以上版本（推荐）

1. **打开Excel文件**
   - 双击打开 `起大区间.xlsx` 或 `隧道线形.xlsx`

2. **另存为**
   - 点击"文件" → "另存为"
   - 或按快捷键 `Ctrl + Shift + S`

3. **选择保存位置**
   - 选择一个容易找到的文件夹
   - 建议：桌面或项目文件夹

4. **选择文件类型** ⭐ 重要！
   - 在"保存类型"下拉菜单中找到：
   - ✅ **"CSV UTF-8（逗号分隔）(*.csv)"**
   - ❌ 不要选择普通的"CSV（逗号分隔）"

5. **输入文件名**
   - 文件名可以保持原样（会自动改为.csv扩展名）
   - 或改为新名字，如：`起大区间_导入版.csv`

6. **保存**
   - 点击"保存"按钮
   - 如果弹出提示，选择"是"或"确定"

7. **重复操作**
   - 对另一个Excel文件重复上述步骤

---

### 方法二：Excel 2013及更早版本

1. **打开Excel文件**

2. **另存为**
   - 文件 → 另存为

3. **选择文件类型**
   - 如果没有"CSV UTF-8"选项：
   - 选择：**"CSV（逗号分隔）(*.csv)"**
   
4. **保存后手动转换编码**
   - 用记事本打开保存的CSV文件
   - 文件 → 另存为
   - 编码选择：**"UTF-8"**
   - 保存

---

### 方法三：WPS Office

1. **打开Excel文件**

2. **另存为**
   - 文件 → 另存为

3. **选择文件类型**
   - 选择：**"文本文件（制表符分隔）(*.txt)"** 
   - 或：**"CSV（逗号分隔）(*.csv)"**

4. **保存后检查**
   - 用记事本打开
   - 另存为 → 编码选UTF-8

---

## ⚠️ 注意事项

### 1. 编码问题
- ✅ 必须使用 **UTF-8** 编码
- ❌ 不要使用 ANSI 或 GB2312
- 否则会出现中文乱码

### 2. 文件路径
- ✅ 建议路径：`D:\项目\数据\`
- ❌ 避免路径：`D:\项目文件夹\中文名称\`
- 尽量避免路径中有中文字符

### 3. 数据完整性
- 转换前后，检查行数是否一致
- 打开CSV文件，确认中文正常显示

---

## ✅ 验证转换成功

### 方法一：用记事本打开

1. 右键点击CSV文件
2. 选择"打开方式" → "记事本"
3. 检查：
   - ✅ 中文正常显示
   - ✅ 数据用逗号分隔
   - ❌ 如果是乱码，重新转换

### 方法二：用Excel打开

1. 双击CSV文件（会用Excel打开）
2. 检查：
   - ✅ 数据正常显示
   - ✅ 格式与原文件一致

---

## 📊 示例对比

### Excel原文件
```
| 序号 | 钻孔编号          | x坐标      | y坐标       |
|------|-------------------|-----------|-------------|
| 1    | M8ZZ3-TQD-2      | 124559.16 | 214931.465  |
```

### 转换后CSV（用记事本查看）
```
序号,,钻孔编号,x坐标,y坐标,孔口高程,里程,地层编号,时代成因,层底标高(m),层底深度(m),分层厚度(m),岩土名称,特征
,,,,,,,,,,,,,,
1,0715起点-大涧站区间,M8ZZ3-TQD-2,124559.16,214931.465,22.53,2540.4,①,Q4ml,21.53,1,1,素填土,褐色、黄褐色...
```

---

## 🔧 常见问题

### Q1: 找不到"CSV UTF-8"选项？
**A**: 
- Excel 2016以下版本可能没有此选项
- 使用方法二：先存为普通CSV，再用记事本转UTF-8

### Q2: 转换后打开是乱码？
**A**:
- 说明编码不是UTF-8
- 重新转换，确保选择UTF-8编码

### Q3: Excel提示"可能丢失部分功能"？
**A**:
- 这是正常的，点击"是"继续
- CSV格式只保存数据，不保存格式

### Q4: 数字变成科学计数法？
**A**:
- 这是正常的，导入时会正确识别
- 或在Excel中设置列格式为"文本"

---

## 💡 快速技巧

### 批量转换（如果有多个文件）

1. **使用Excel宏**
   - 录制一个宏，自动执行"另存为CSV UTF-8"
   - 对每个文件运行宏

2. **使用在线工具**
   - 搜索"Excel转CSV在线工具"
   - 注意选择UTF-8编码

3. **使用命令行**（需要Python）
   ```bash
   python convert_excel_to_csv.py
   ```

---

## 📞 还有问题？

如果按照上述步骤仍然无法成功转换，请：
1. 检查Excel版本
2. 尝试使用WPS Office
3. 使用在线转换工具
4. 联系技术支持

---

**提示**：转换完成后，建议将原Excel文件和CSV文件都保存好，方便以后使用。
